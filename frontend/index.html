<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Portfolio Tracker - Resource Exchange</title>
    <link rel="stylesheet" href="/style.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body>
    <header class="header">
      <div class="header-content">
        <div class="logo">
          <h1>Portfolio Tracker</h1>
          <p>Resource Exchange Simulator</p>
        </div>
        <div id="userInfo" class="user-info hidden">
          <div class="balance-card">
            <span class="balance-label">Balance</span>
            <span id="userBalance" class="balance-amount">Â£0.00</span>
          </div>
          <div class="user-welcome">
            <span>Welcome, <strong id="username"></strong>!</span>
            <button class="btn btn-outline" onclick="logout()">Logout</button>
          </div>
        </div>
      </div>
    </header>

    <div class="container">
      <div id="authSection" class="auth-section">
        <div class="card auth-card">
          <div class="card-header">
            <h2 class="card-title">Login</h2>
          </div>
          <div id="loginMessage"></div>
          <div class="form-group">
            <label for="loginUsername">Username</label>
            <input
              type="text"
              id="loginUsername"
              placeholder="Enter username"
            />
          </div>
          <div class="form-group">
            <label for="loginPassword">Password</label>
            <input
              type="password"
              id="loginPassword"
              placeholder="Enter password"
            />
          </div>
          <button class="btn btn-primary" onclick="login()">Login</button>
        </div>

        <div class="card auth-card">
          <div class="card-header">
            <h2 class="card-title">Register</h2>
          </div>
          <div id="registerMessage"></div>
          <div class="form-group">
            <label for="registerUsername">Username</label>
            <input
              type="text"
              id="registerUsername"
              placeholder="Choose username"
            />
          </div>
          <div class="form-group">
            <label for="registerEmail">Email</label>
            <input type="email" id="registerEmail" placeholder="Enter email" />
          </div>
          <div class="form-group">
            <label for="registerPassword">Password</label>
            <input
              type="password"
              id="registerPassword"
              placeholder="Choose password"
            />
          </div>
          <button class="btn btn-success" onclick="register()">Register</button>
        </div>
      </div>

      <div id="mainApp" class="hidden">
        <!-- Trading Stuff -->
        <div class="card trading-section">
          <div class="card-header">
            <h2 class="card-title">Market Trading</h2>
            <p class="card-subtitle">Buy and sell resources in real-time</p>
          </div>
          <div id="resourcesGrid" class="resources-grid"></div>
        </div>

        <!-- Portfolio Stuff -->
        <div class="portfolio-overview">
          <div class="card portfolio-card">
            <div class="card-header">
              <h2 class="card-title">Portfolio Overview</h2>
              <p class="card-subtitle">Your current holdings and performance</p>
              <button
                class="btn btn-primary"
                onclick="testPandLUpdate()"
                style="margin-top: 1rem"
              >
                Test P&L Update
              </button>
            </div>
            <div id="positionsContent">
              <div class="loading">Loading portfolio...</div>
            </div>
            <table id="positionsTable" class="table hidden">
              <thead>
                <tr>
                  <th>Asset</th>
                  <th>Quantity</th>
                  <th>Avg Price</th>
                  <th>Current Value</th>
                  <th>P&L</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody id="positionsTableBody"></tbody>
            </table>
          </div>

          <!-- Portfolio Chart Stuff -->
          <div class="card chart-card">
            <div class="card-header">
              <h2 class="card-title">Portfolio Distribution</h2>
              <p class="card-subtitle">Visual breakdown of your holdings</p>
            </div>
            <div class="chart-container">
              <canvas id="portfolioChart"></canvas>
            </div>
          </div>
        </div>

        <!-- Transaction Stuff -->
        <div class="card">
          <div class="card-header">
            <h2 class="card-title">Transaction History</h2>
            <p class="card-subtitle">Your recent trading activity</p>
          </div>
          <div id="transactionsContent">
            <div class="loading">Loading transactions...</div>
          </div>
          <table id="transactionsTable" class="table hidden">
            <thead>
              <tr>
                <th>Asset</th>
                <th>Type</th>
                <th>Quantity</th>
                <th>Price</th>
                <th>Total</th>
                <th>Time</th>
              </tr>
            </thead>
            <tbody id="transactionsTableBody"></tbody>
          </table>
        </div>
      </div>
    </div>

    <script src="/script.js"></script>
  </body>
</html>
